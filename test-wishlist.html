<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wishlist Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Wishlist Functionality Test</h1>
    
    <div class="test-section">
        <h2>Test Results</h2>
        <div id="test-results"></div>
        <button onclick="runTests()">Run Tests</button>
        <button onclick="clearResults()">Clear Results</button>
    </div>

    <div class="test-section">
        <h2>Manual Test</h2>
        <p>To manually test the wishlist functionality:</p>
        <ol>
            <li>Open the main website at <a href="http://localhost:8000" target="_blank">http://localhost:8000</a></li>
            <li>Scroll down to the "Fresh From Our Collection" section</li>
            <li>Try clicking the heart icon on any product (should prompt login if not authenticated)</li>
            <li>After logging in, click the heart icon again to add to favorites</li>
            <li>Verify the heart changes to filled and the product shows hover effects</li>
            <li>Check that the wishlist count in the header updates</li>
            <li>Hover over favorited products to see the filled heart and pulsing animation</li>
        </ol>
    </div>

    <script type="module">
        async function runTests() {
            const resultsDiv = document.getElementById('test-results');
            resultsDiv.innerHTML = '<div class="test-result warning">Running tests...</div>';
            
            const tests = [];

            // Test 1: Check if wishlist service is available
            try {
                const wishlistModule = await import('./chandriahomepage/assets/js/wishlist-firebase.js');
                tests.push({
                    name: 'Wishlist service import',
                    result: 'success',
                    message: 'Wishlist service module loaded successfully'
                });
                
                // Test 2: Check if wishlist service has required methods
                const service = wishlistModule.default;
                const requiredMethods = ['addToWishlist', 'removeFromWishlist', 'toggleWishlist', 'isProductInWishlist', 'getUserWishlist', 'updateWishlistCountUI'];
                
                const missingMethods = requiredMethods.filter(method => typeof service[method] !== 'function');
                
                if (missingMethods.length === 0) {
                    tests.push({
                        name: 'Wishlist service methods',
                        result: 'success',
                        message: 'All required methods are available'
                    });
                } else {
                    tests.push({
                        name: 'Wishlist service methods',
                        result: 'error',
                        message: `Missing methods: ${missingMethods.join(', ')}`
                    });
                }
                
            } catch (error) {
                tests.push({
                    name: 'Wishlist service import',
                    result: 'error',
                    message: `Failed to import wishlist service: ${error.message}`
                });
            }

            // Test 3: Check if CSS hover effects are applied
            try {
                const response = await fetch('./chandriahomepage/assets/css/product-cards.css');
                const cssContent = await response.text();
                
                const hasHoverEffects = cssContent.includes('.product-item.in-wishlist:hover') &&
                                       cssContent.includes('heartPulse') &&
                                       cssContent.includes('f15e');
                
                if (hasHoverEffects) {
                    tests.push({
                        name: 'CSS hover effects',
                        result: 'success',
                        message: 'Hover effects for favorited products are implemented'
                    });
                } else {
                    tests.push({
                        name: 'CSS hover effects',
                        result: 'error',
                        message: 'Missing CSS hover effects for favorited products'
                    });
                }
            } catch (error) {
                tests.push({
                    name: 'CSS hover effects',
                    result: 'error',
                    message: `Failed to check CSS: ${error.message}`
                });
            }

            // Test 4: Check if index.html includes the wishlist script
            try {
                const response = await fetch('./index.html');
                const htmlContent = await response.text();
                
                const hasWishlistScript = htmlContent.includes('wishlist-firebase.js');
                
                if (hasWishlistScript) {
                    tests.push({
                        name: 'HTML script inclusion',
                        result: 'success',
                        message: 'Wishlist script is included in index.html'
                    });
                } else {
                    tests.push({
                        name: 'HTML script inclusion',
                        result: 'error',
                        message: 'Wishlist script is not included in index.html'
                    });
                }
            } catch (error) {
                tests.push({
                    name: 'HTML script inclusion',
                    result: 'error',
                    message: `Failed to check HTML: ${error.message}`
                });
            }

            // Display results
            let resultsHTML = '';
            tests.forEach(test => {
                resultsHTML += `<div class="test-result ${test.result}">
                    <strong>${test.name}:</strong> ${test.message}
                </div>`;
            });
            
            resultsDiv.innerHTML = resultsHTML;
        }

        function clearResults() {
            document.getElementById('test-results').innerHTML = '';
        }

        // Make functions global
        window.runTests = runTests;
        window.clearResults = clearResults;
    </script>
</body>
</html>
